fn main() {
    a := 1.5;
    return -a;
}

fn foreach(F: Ast)(a: !A) {
    r := &range(a);
    while !r.empty {
        F(r.front);
        popFront(r);
    }
}

fn range(E := typeof(e[0]))(e: []E) {
    return {
        empty: e.count == 0,
        index: 0,
        target: e,
        front: e[0]
    };
}

fn popFront(r: !R) {
    if r.empty { return; }

    if r.index + 1 == r.target.count {
        r.empty = true;
        return;
    }

    r.index = r.index + 1;
    r.front = r.target[r.index];
}
